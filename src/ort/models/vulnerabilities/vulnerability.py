# SPDX-FileCopyrightText: 2026 Helio Chissini de Castro <heliocastro@gmail.com>
# SPDX-License-Identifier: MIT

from pydantic import BaseModel, ConfigDict, Field

from .vulnerability_reference import VulnerabilityReference


class Vulnerability(BaseModel):
    """
    Base model for all vulnerability providers supported by the advisor.

    This class stores the information about a single vulnerability, which may have been retrieved from multiple
    vulnerability providers. For each source of information a [VulnerabilityReference] is contained.
    """

    model_config = ConfigDict(
        extra="forbid",
    )

    id: str = Field(
        ...,
        description="The ID of a vulnerability. Most likely a CVE identifier.",
    )

    summary: str | None = Field(
        None,
        description="A short summary of this Vulnerability.",
    )

    description: str | None = Field(
        None,
        description="A full description of this Vulnerability.",
    )

    references: list["VulnerabilityReference"] = Field(
        ...,
        description="A list with detailed information for this vulnerability obtained from different sources.",
    )
