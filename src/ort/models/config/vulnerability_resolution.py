# SPDX-FileCopyrightText: 2026 Helio Chissini de Castro <heliocastro@gmail.com>
# SPDX-License-Identifier: MIT


from pydantic import BaseModel, ConfigDict, Field

from .vulnerability_resolution_reason import VulnerabilityResolutionReason


class VulnerabilityResolution(BaseModel):
    """
    Defines the resolution of an [Vulnerability]. This can be used to silence false positives, or
    vulnerabilities that have been identified as not being relevant.
    """

    model_config = ConfigDict(
        extra="forbid",
    )

    message: str = Field(
        description="A regular expression to match the id, e.g. a CVE, of the vulnerability to resolve."
        "Will be converted to a [Regex] using [RegexOption.DOT_MATCHES_ALL]."
    )

    reason: VulnerabilityResolutionReason = Field(
        description="The reason why the vulnerability is resolved.",
    )

    comment: str = Field(
        description="A comment to further explain why the [reason] is applicable here.",
    )
